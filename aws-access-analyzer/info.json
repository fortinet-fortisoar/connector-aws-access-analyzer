{
  "name": "aws-access-analyzer",
  "label": "AWS Access Analyzer",
  "description": "AWS Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, shared with an external entity, enabling you to identify unintended access to your resources and data, which is a security risk. ",
  "publisher": "Community",
  "cs_approved": false,
  "cs_compatible": true,
  "version": "1.0.0",
  "category": "AWS Service",
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.0.0/aws-access-analyzer/265/aws-access-analyzer-v1-0-0",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "configuration": {
    "fields": [
      {
        "title": "Configuration Type",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "select",
        "name": "config_type",
        "tooltip": "AWS configuration type",
        "description": "Type of configuration using which you will provide credentials to access AWS Access Analyzer and perform automated actions. You can select betweenIAM RoleorAccess Credentials. If you selectIAM Role, then enter details in the following field(s): AWS Instance IAM Role: IAM Role of your AWS instance to access AWS services. If you selectAccess Credentials, then enter details in the following field(s): AWS Region: AWS region of your account to access the AWS Access Analyzer. AWS Access Key ID: ID of the AWS Access Key to access AWS services. AWS Secret Access Key: Key of the AWS Secret Access to access AWS services.",
        "options": [
          "IAM Role",
          "Access Credentials"
        ],
        "onchange": {
          "IAM Role": [
            {
              "title": "AWS Instance IAM Role",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_iam_role",
              "tooltip": "IAM Role of your AWS instance to access AWS services.",
              "description": "IAM Role of your AWS instance to access AWS services."
            }
          ],
          "Access Credentials": [
            {
              "title": "AWS Region",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_region",
              "placeholder": "e.g. us-east-2",
              "tooltip": "AWS region of your account to access the AWS Access Analyzer",
              "description": "AWS region of your account to access the AWS Access Analyzer"
            },
            {
              "title": "AWS Access Key ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_access_key",
              "tooltip": "ID of the AWS Access Key to access AWS services",
              "description": "ID of the AWS Access Key to access AWS services"
            },
            {
              "title": "AWS Secret Access Key",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "aws_secret_access_key",
              "tooltip": "Key of the AWS Secret Access to access AWS services",
              "description": "Key of the AWS Secret Access to access AWS services"
            }
          ]
        }
      },
      {
        "title": "Verify SSL",
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true
      }
    ]
  },
  "operations": [
    {
      "operation": "list_analyzers",
      "title": "List Analyzers",
      "category": "investigation",
      "annotation": "list_analyzers",
      "description": "Retrieves a list of analyzers based on the analyzer type and other input parameters you have specified. ",
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Type",
          "type": "select",
          "name": "type",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of analyzers.",
          "description": "Select the type of analyzers that you want to retrieve using AWS Access Analyzer. You can choose either 'ACCOUNT' or 'ORGANIZATION'.",
          "options": [
            "ACCOUNT",
            "ORGANIZATION"
          ]
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": true,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of analyzer list",
          "description": "Specify the maximum size of the analyzer list that you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "(Optional) The next page token is used for paginating through large result sets. A next page token will be returned whenever the set of available results exceeds the current page size. You can use this parameter to retrieve the next page records using the 'nextToken' value and it is not required for the first page."
        }

      ],
      "enabled": true,
      "output_schema": {
        "analyzers":[
          {
             "arn":"",
             "createdAt":"",
             "lastResourceAnalyzed":"",
             "lastResourceAnalyzedAt":"",
             "name":"",
             "status":"",
             "statusReason":{
                "code":""
             },
             "tags":{
                "string":""
             },
             "type":""
          }
       ],
       "nextToken":""
    }
    },
    {
      "operation": "list_analyzers_only_names",
      "title": "List Analyzers only names.",
      "category": "investigation",
      "annotation": "list_analyzers_only_names",
      "description": "Retrieves a list of analyzers only name.",
      "visible": false,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Type",
          "type": "select",
          "name": "type",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of analyzers.",
          "description": "Select the type of analyzers either 'ACCOUNT' or 'ORGANIZATION'",
          "options": [
            "ACCOUNT",
            "ORGANIZATION"
          ]
        }
      ],
      "enabled": true,
      "output_schema": []
    },
    {
      "operation": "list_analyzers_only_arn",
      "title": "List Analyzers only ARNs.",
      "category": "investigation",
      "annotation": "list_analyzers_only_arn",
      "description": "Retrieves a list of analyzers only arn.",
      "visible": false,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Type",
          "type": "select",
          "name": "type",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of analyzers.",
          "description": "Select the type of analyzers either 'ACCOUNT' or 'ORGANIZATION'",
          "options": [
            "ACCOUNT",
            "ORGANIZATION"
          ]
        }
      ],
      "enabled": true,
      "output_schema": []
    },
    {
      "operation": "get_analyzers",
      "title": "Get analyzer details",
      "category": "investigation",
      "annotation": "get_analyzers",
      "description": "Retrieves information about the specified analyzer based on the analyzer name and other input parameters you have specified.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Name",
          "type": "select",
          "name": "analyzer_name",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the name of analyzers.",
          "description": "Select the name of the analyzer whose details you want to retrieve using AWS Access Analyzer. This parameter makes an API call named \"list_analyzers_only_names\" to dynamically populate the Analyzer Name's drop-down selections. ",
          "apiOperation": "list_analyzers_only_names"
        }
      ],
      "enabled": true,
      "output_schema": {
       "arn":"",
       "createdAt":"",
       "lastResourceAnalyzed":"",
       "lastResourceAnalyzedAt":"",
       "name":"",
       "status":"",
       "statusReason":{
          "code":""
       },
       "tags":{
          "string":""
       },
       "type":""
    }
    },
    {
      "operation": "list_analyzed_resources",
      "title": "List of Analyzed Resources",
      "category": "investigation",
      "annotation": "list_analyzed_resources",
      "description": "Retrieves a list of specified resource types that have been analyzed by the specified analyzer based on the analyzer ARN, resource type, and other input parameters you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the ARN of the analyzer whose analyzed resources you want to retrieve using AWS Access Analyzer. This parameter makes an API call named \"list_analyzers_only_arn\" to dynamically populate the Analyzer ARN's drop-down selections. ",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource Type",
          "type": "select",
          "name": "resource_type",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of resources.",
          "description": "Select the type of resources you want to retrieve using AWS Access Analyzer. You can choose from resource types such as AWS::IAM::Role, AWS::S3::Bucket, AWS::KMS::Key, etc. ",
          "options": [
            "AWS::S3::Bucket",
            "AWS::IAM::Role",
            "AWS::SQS::Queue",
            "AWS::Lambda::Function",
            "AWS::Lambda::LayerVersion",
            "AWS::KMS::Key",
            "AWS::SecretsManager::Secret"
          ]
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": true,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of analyzed resource list",
          "description": "Specify the maximum size of the analyzed resource list that you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "(Optional) The next page token is used for paginating through large result sets. A next page token will be returned whenever the set of available results exceeds the current page size. You can use this parameter to retrieve the next page records using the 'nextToken' value and it is not required for the first page."
        }
      ],
      "enabled": true,
      "output_schema": {
         "analyzedResources":[
            {
               "resourceArn":"",
               "resourceOwnerAccount":"",
               "resourceType":""
            }
         ],
         "nextToken":""
      }
    },
    {
      "operation": "list_analyzed_resources_only_arn",
      "title": "List of Analyzed Resources",
      "category": "investigation",
      "annotation": "list_analyzed_resources_only_arn",
      "description": "Retrieves a list of resources of the specified type that have been analyzed by the specified analyzer.",
      "visible": false,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource Type",
          "type": "select",
          "name": "resource_type",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of resources.",
          "description": "Select the type of resources",
          "options": [
            "AWS::S3::Bucket",
            "AWS::IAM::Role",
            "AWS::SQS::Queue",
            "AWS::Lambda::Function",
            "AWS::Lambda::LayerVersion",
            "AWS::KMS::Key",
            "AWS::SecretsManager::Secret"
          ]
        }
      ],
      "enabled": true,
      "output_schema": [""]
    },
    {
      "operation": "get_analyzed_resources",
      "title": "Details of an Analyzed Resources",
      "category": "investigation",
      "annotation": "get_analyzed_resources",
      "description": "Retrieves information about a resource that was analyzed by the specified analyzer based on the analyzer ARN and resource ARN you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the ARN of the analyzer whose analyzed resource details you want to retrieve using AWS Access Analyzer. This parameter makes an API call named \"list_analyzers_only_arn\" to dynamically populate the Analyzer ARN's drop-down selections. ",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource ARN",
          "type": "select",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of resources.",
          "description": "Select the ARN of resources that were analyzed using the specified analyzer. This parameter makes an API call named \"list_analyzed_resources_only_arn\" to dynamically populate the Resource ARN's drop-down selections. ",
          "apiOperation": "list_analyzed_resources_only_arn"
        }
      ],
      "enabled": true,
      "output_schema": {
       "resource":{
          "actions":[
             ""
          ],
          "analyzedAt":"",
          "createdAt":"",
          "error":"",
          "isPublic":"",
          "resourceArn":"",
          "resourceOwnerAccount":"",
          "resourceType":"",
          "sharedVia":[
             ""
          ],
          "status":"",
          "updatedAt":""
       }
    }
    },
    {
      "operation": "list_findings",
      "title": "List of Findings",
      "category": "investigation",
      "annotation": "list_findings",
      "description": "Retrieves a list of findings generated by the specified analyzer based on the analyzer ARN and other input parameters you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the ARN of the analyzer whose findings you want to retrieve using AWS Access Analyzer. This parameter makes an API call named \"list_analyzers_only_arn\" to dynamically populate the Analyzer ARN's drop-down selections. ",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": true,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of finding list",
          "description": "Specify the maximum size of the findings list that you want to retrieve using AWS Access Analyzer."
        },
        {
          "title": "Filter Query",
          "type": "json",
          "name": "filter",
          "required": false,
          "editable": true,
          "visible": true,
          "value": null,
          "placeholder": {},
          "tooltip": "Specifies the filter query.",
          "description": "(Optional) Specify a query using which you want to filter the finding list retrieved using AWS Access Analyzer. "
        },
        {
          "title": "Sort Parameter",
          "type": "json",
          "name": "sort",
          "required": false,
          "editable": true,
          "visible": true,
          "value": null,
          "placeholder": {},
          "tooltip": "Specifies the sort attributes",
          "description": "(Optional) Specify the attributes using which you want to sort the finding list retrieved using AWS Access Analyzer. "
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "(Optional) The next page token is used for paginating through large result sets. A next page token will be returned whenever the set of available results exceeds the current page size. You can use this parameter to retrieve the next page records using the 'nextToken' value and it is not required for the first page.  "
        }

      ],
      "enabled": true,
      "output_schema": {
         "findings":[
            {
               "action":[
                  ""
               ],
               "analyzedAt":"",
               "condition":{
                  "string":""
               },
               "createdAt":"",
               "error":"",
               "id":"",
               "isPublic":"",
               "principal":{
                  "string":""
               },
               "resource":"",
               "resourceOwnerAccount":"",
               "resourceType":"",
               "sources":[
                  {
                     "detail":{
                        "accessPointArn":""
                     },
                     "type":""
                  }
               ],
               "status":"",
               "updatedAt":""
            }
         ],
         "nextToken":""
      }
    },
    {
      "operation": "get_findings",
      "title": "Get Finding Details",
      "category": "investigation",
      "annotation": "get_findings",
      "description": "Retrieves information about the specified finding generated by the specified analyzer based on the analyzer ARN and finding ID you have specified.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the ARN of the analyzer whose finding details you want to retrieve using AWS Access Analyzer. This parameter makes an API call named \"list_analyzers_only_arn\" to dynamically populate the Analyzer ARN's drop-down selections. ",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "ID",
          "type": "text",
          "name": "id",
          "required": true,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the id of findings",
          "description": "Specify the ID of findings whose details you want to retrieve using AWS Access Analyzer. "
        }
      ],
      "enabled": true,
      "output_schema": {
       "finding":{
          "action":[
             ""
          ],
          "analyzedAt":"",
          "condition":{
             "string":""
          },
          "createdAt":"",
          "error":"",
          "id":"",
          "isPublic":"",
          "principal":{
             "string":""
          },
          "resource":"",
          "resourceOwnerAccount":"",
          "resourceType":"",
          "sources":[
             {
                "detail":{
                   "accessPointArn":""
                },
                "type":""
             }
          ],
          "status":"",
          "updatedAt":""
       }
    }
    },
    {
      "operation": "start_resource_scan",
      "title": "Start Resource Scan",
      "category": "investigation",
      "annotation": "start_resource_scan",
      "description": "Immediately starts a scan of the policies applied to the specified resource based on the analyzer ARN and resource ARN you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the ARN of the analyzer using which you want to scan the policies on the specified resource. This parameter makes an API call named \"list_analyzers_only_arn\" to dynamically populate the Analyzer ARN's drop-down selections. ",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource ARN",
          "type": "select",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of resources.",
          "description": "Select the ARN of resources whose associated policies you want to scan using the specified analyzer. This parameter makes an API call named \"list_analyzed_resources_only_arn\" to dynamically populate the Resource ARN's drop-down selections. ",
          "apiOperation": "list_analyzed_resources_only_arn"
        }
      ],
      "enabled": true,
      "output_schema": {}
    },
    {
      "operation": "update_findings",
      "title": "Update Findings Status",
      "category": "investigation",
      "annotation": "update_findings",
      "description": "Updates the status of the specified findings of a specified analyzer based on the analyzer ARN, resource ARN, findings IDs, and other input parameters you have specified. ",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the ARN of the analyzer whose findings' status you want to update using AWS Access Analyzer. This parameter makes an API call named \"list_analyzers_only_arn\" to dynamically populate the Analyzer ARN's drop-down selections. ",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource ARN",
          "type": "select",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of resources.",
          "description": "Select the ARN of resources whose findings' status you want to update using the specified analyzer. This parameter makes an API call named \"list_analyzed_resources_only_arn\" to dynamically populate the Resource ARN's drop-down selections. ",
          "apiOperation": ""
        },
        {
          "title": "ID List",
          "type": "json",
          "name": "ids",
          "required": true,
          "editable": true,
          "visible": true,
          "value": [],
          "placeholder": ["id1", "id2"],
          "tooltip": "Comma separated list of ID's.",
          "description": "Specify a comma-separated list of findings' IDs whose status you want to update using AWS Access Analyzer. "
        },
        {
          "title": "Status",
          "type": "select",
          "name": "status",
          "required": true,
          "editable": true,
          "visible": true,
          "value": "ACTIVE",
          "tooltip": "Select the status of the specified findings as either 'ACTIVE' or 'ARCHIVED'. ",
          "description": "Select the status of the specified findings as either 'ACTIVE' or 'ARCHIVED'. ",
          "options": [
            "ACTIVE",
            "ARCHIVED"
          ]
        },
        {
          "title": "Client Token",
          "type": "text",
          "name": "client_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the client token",
          "description": "Specify the client token to update the status of the specified findings. "
        }
      ],
      "enabled": true,
      "output_schema": null
    }
  ]

}