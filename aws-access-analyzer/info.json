{
  "name": "aws-access-analyzer",
  "label": "AWS Access Analyzer",
  "description": "Identity and Access Management Access Analyzer helps identify potential resource-access risks by enabling you to identify any policies that grant access to an external principal.",
  "publisher": "Community",
  "cs_approved": false,
  "cs_compatible": true,
  "version": "1.0.0",
  "category": "AWS Service",
  "help_online": "",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "configuration": {
    "fields": [
      {
        "title": "Configuration Type",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "select",
        "name": "config_type",
        "tooltip": "AWS configuration type",
        "description": "Type of configuration using which you will provide credentials to access AWS Access Analyzer and perform automated actions. You can select betweenIAM RoleorAccess Credentials. If you selectIAM Role, then enter details in the following field(s): AWS Instance IAM Role: IAM Role of your AWS instance to access AWS services. If you selectAccess Credentials, then enter details in the following field(s): AWS Region: AWS region of your account to access the AWS Access Analyzer. AWS Access Key ID: ID of the AWS Access Key to access AWS services. AWS Secret Access Key: Key of the AWS Secret Access to access AWS services.",
        "options": [
          "IAM Role",
          "Access Credentials"
        ],
        "onchange": {
          "IAM Role": [
            {
              "title": "AWS Instance IAM Role",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_iam_role",
              "tooltip": "IAM Role of your AWS instance to access AWS services.",
              "description": "IAM Role of your AWS instance to access AWS services."
            }
          ],
          "Access Credentials": [
            {
              "title": "AWS Region",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_region",
              "placeholder": "e.g. us-east-2",
              "tooltip": "AWS region of your account to access the AWS Access Analyzer",
              "description": "AWS region of your account to access the AWS Access Analyzer"
            },
            {
              "title": "AWS Access Key ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "aws_access_key",
              "tooltip": "ID of the AWS Access Key to access AWS services",
              "description": "ID of the AWS Access Key to access AWS services"
            },
            {
              "title": "AWS Secret Access Key",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "aws_secret_access_key",
              "tooltip": "Key of the AWS Secret Access to access AWS services",
              "description": "Key of the AWS Secret Access to access AWS services"
            }
          ]
        }
      },
      {
        "title": "Verify SSL",
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true
      }
    ]
  },
  "operations": [
    {
      "operation": "list_analyzers",
      "title": "List Analyzers",
      "category": "investigation",
      "annotation": "list_analyzers",
      "description": "Retrieves a list of analyzers.",
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Type",
          "type": "select",
          "name": "type",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of analyzers.",
          "description": "Select the type of analyzers either 'ACCOUNT' or 'ORGANIZATION'",
          "options": [
            "ACCOUNT",
            "ORGANIZATION"
          ]
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": true,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of analyzer list",
          "description": "Specifies the maximum size of analyzer list"
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data."
        }

      ],
      "enabled": true,
      "output_schema": {
        "analyzers":[
          {
             "arn":"",
             "createdAt":"",
             "lastResourceAnalyzed":"",
             "lastResourceAnalyzedAt":"",
             "name":"",
             "status":"",
             "statusReason":{
                "code":""
             },
             "tags":{
                "string":""
             },
             "type":""
          }
       ],
       "nextToken":""
    }
    },
    {
      "operation": "list_analyzers_only_names",
      "title": "List Analyzers only names.",
      "category": "investigation",
      "annotation": "list_analyzers_only_names",
      "description": "Retrieves a list of analyzers only name.",
      "visible": false,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Type",
          "type": "select",
          "name": "type",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of analyzers.",
          "description": "Select the type of analyzers either 'ACCOUNT' or 'ORGANIZATION'",
          "options": [
            "ACCOUNT",
            "ORGANIZATION"
          ]
        }
      ],
      "enabled": true,
      "output_schema": []
    },
    {
      "operation": "list_analyzers_only_arn",
      "title": "List Analyzers only ARNs.",
      "category": "investigation",
      "annotation": "list_analyzers_only_arn",
      "description": "Retrieves a list of analyzers only arn.",
      "visible": false,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Type",
          "type": "select",
          "name": "type",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of analyzers.",
          "description": "Select the type of analyzers either 'ACCOUNT' or 'ORGANIZATION'",
          "options": [
            "ACCOUNT",
            "ORGANIZATION"
          ]
        }
      ],
      "enabled": true,
      "output_schema": []
    },
    {
      "operation": "get_analyzers",
      "title": "Get analyzer details",
      "category": "investigation",
      "annotation": "get_analyzers",
      "description": "Retrieves information about the specified analyzer.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer Name",
          "type": "select",
          "name": "analyzer_name",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the name of analyzers.",
          "description": "Select the name of analyzers from list",
          "apiOperation": "list_analyzers_only_names"
        }
      ],
      "enabled": true,
      "output_schema": {
       "arn":"",
       "createdAt":"",
       "lastResourceAnalyzed":"",
       "lastResourceAnalyzedAt":"",
       "name":"",
       "status":"",
       "statusReason":{
          "code":""
       },
       "tags":{
          "string":""
       },
       "type":""
    }
    },
    {
      "operation": "list_analyzed_resources",
      "title": "List of Analyzed Resources",
      "category": "investigation",
      "annotation": "list_analyzed_resources",
      "description": "Retrieves a list of resources of the specified type that have been analyzed by the specified analyzer.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource Type",
          "type": "select",
          "name": "resource_type",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of resources.",
          "description": "Select the type of resources",
          "options": [
            "AWS::S3::Bucket",
            "AWS::IAM::Role",
            "AWS::SQS::Queue",
            "AWS::Lambda::Function",
            "AWS::Lambda::LayerVersion",
            "AWS::KMS::Key",
            "AWS::SecretsManager::Secret"
          ]
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": true,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of analyzed resource list",
          "description": "Specifies the maximum size of analyzed resource list"
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data."
        }
      ],
      "enabled": true,
      "output_schema": {
         "analyzedResources":[
            {
               "resourceArn":"",
               "resourceOwnerAccount":"",
               "resourceType":""
            }
         ],
         "nextToken":""
      }
    },
    {
      "operation": "list_analyzed_resources_only_arn",
      "title": "List of Analyzed Resources",
      "category": "investigation",
      "annotation": "list_analyzed_resources_only_arn",
      "description": "Retrieves a list of resources of the specified type that have been analyzed by the specified analyzer.",
      "visible": false,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource Type",
          "type": "select",
          "name": "resource_type",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "select the type of resources.",
          "description": "Select the type of resources",
          "options": [
            "AWS::S3::Bucket",
            "AWS::IAM::Role",
            "AWS::SQS::Queue",
            "AWS::Lambda::Function",
            "AWS::Lambda::LayerVersion",
            "AWS::KMS::Key",
            "AWS::SecretsManager::Secret"
          ]
        }
      ],
      "enabled": true,
      "output_schema": [""]
    },
    {
      "operation": "get_analyzed_resources",
      "title": "Details of an Analyzed Resources",
      "category": "investigation",
      "annotation": "get_analyzed_resources",
      "description": "Retrieves information about a resource that was analyzed.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource ARN",
          "type": "select",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of resources.",
          "description": "Select the arn of resources",
          "apiOperation": "list_analyzed_resources_only_arn"
        }
      ],
      "enabled": true,
      "output_schema": {
       "resource":{
          "actions":[
             ""
          ],
          "analyzedAt":"",
          "createdAt":"",
          "error":"",
          "isPublic":"",
          "resourceArn":"",
          "resourceOwnerAccount":"",
          "resourceType":"",
          "sharedVia":[
             ""
          ],
          "status":"",
          "updatedAt":""
       }
    }
    },
    {
      "operation": "list_findings",
      "title": "List of Findings",
      "category": "investigation",
      "annotation": "list_findings",
      "description": "Retrieves a list of findings generated by the specified analyzer.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Max Result Size",
          "type": "integer",
          "name": "size",
          "required": true,
          "editable": true,
          "visible": true,
          "value": 10,
          "placeholder": 10,
          "tooltip": "Specifies the maximum size of finding list",
          "description": "Specifies the maximum size of findings list"
        },
        {
          "title": "Filter Query",
          "type": "json",
          "name": "filter",
          "required": false,
          "editable": true,
          "visible": true,
          "value": null,
          "placeholder": {},
          "tooltip": "Specifies the filter query.",
          "description": "Specifies the filter query."
        },
        {
          "title": "Sort Parameter",
          "type": "json",
          "name": "sort",
          "required": false,
          "editable": true,
          "visible": true,
          "value": null,
          "placeholder": {},
          "tooltip": "Specifies the sort attributes",
          "description": "Specifies the sort attributes."
        },
        {
          "title": "Next Page Token",
          "type": "text",
          "name": "next_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data.",
          "description": "Specifies the next page token. Not required for the first page. And you can find 'nextToken' value in first page data."
        }

      ],
      "enabled": true,
      "output_schema": {
         "findings":[
            {
               "action":[
                  ""
               ],
               "analyzedAt":"",
               "condition":{
                  "string":""
               },
               "createdAt":"",
               "error":"",
               "id":"",
               "isPublic":"",
               "principal":{
                  "string":""
               },
               "resource":"",
               "resourceOwnerAccount":"",
               "resourceType":"",
               "sources":[
                  {
                     "detail":{
                        "accessPointArn":""
                     },
                     "type":""
                  }
               ],
               "status":"",
               "updatedAt":""
            }
         ],
         "nextToken":""
      }
    },
    {
      "operation": "get_findings",
      "title": "Get Finding Details",
      "category": "investigation",
      "annotation": "get_findings",
      "description": "Retrieves information about the specified finding.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "ID",
          "type": "text",
          "name": "id",
          "required": true,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the id of findings",
          "description": "Specifies the id of findings"
        }
      ],
      "enabled": true,
      "output_schema": {
       "finding":{
          "action":[
             ""
          ],
          "analyzedAt":"",
          "condition":{
             "string":""
          },
          "createdAt":"",
          "error":"",
          "id":"",
          "isPublic":"",
          "principal":{
             "string":""
          },
          "resource":"",
          "resourceOwnerAccount":"",
          "resourceType":"",
          "sources":[
             {
                "detail":{
                   "accessPointArn":""
                },
                "type":""
             }
          ],
          "status":"",
          "updatedAt":""
       }
    }
    },
    {
      "operation": "start_resource_scan",
      "title": "Start Resource Scan",
      "category": "investigation",
      "annotation": "start_resource_scan",
      "description": "Immediately starts a scan of the policies applied to the specified resource.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource ARN",
          "type": "select",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of resources.",
          "description": "Select the arn of resources",
          "apiOperation": "list_analyzed_resources_only_arn"
        }
      ],
      "enabled": true,
      "output_schema": {}
    },
    {
      "operation": "update_findings",
      "title": "Update Findings Status",
      "category": "investigation",
      "annotation": "update_findings",
      "description": "Updates the status for the specified findings.",
      "visible": true,
      "parameters": [
        {
          "title": "Assume a Role",
          "type": "checkbox",
          "name": "assume_role",
          "required": false,
          "editable": true,
          "visible": true,
          "tooltip": "Enable to assume a role",
          "description": "Select this option to assume a role. This parameter is required, if you have specified 'IAM Role' as the 'Configuration Type'. If you have specified 'Access Credentials' as the 'Configuration Type', then this parameter is optional. If you choose'True', then you must specify the following parameters: AWS Region: AWS region of your account to access the AWS Access Analyzer Role ARN: ARN of the role that you want assume to execute this action on AWS. Session Name: Name of the session that will be created to execute this action on AWS.",
          "value": false,
          "onchange": {
            "true": [
              {
                "title": "AWS Region",
                "required": true,
                "editable": true,
                "visible": true,
                "type": "text",
                "name": "aws_region",
                "placeholder": "e.g. us-east-2",
                "tooltip": "Your account's AWS region",
                "description": "AWS region of your account to access the AWS Access Analyzer"
              },
              {
                "title": "Role ARN",
                "type": "text",
                "name": "role_arn",
                "required": true,
                "editable": true,
                "visible": true,
                "placeholder": "arn:aws:iam::{{account_id}}:role/{{role_name}}",
                "tooltip": "ARN of the role that you want assume to execute this action on AWS.",
                "description": "ARN of the role that you want assume to execute this action on AWS."
              },
              {
                "title": "Session Name",
                "type": "text",
                "name": "session_name",
                "required": true,
                "editable": true,
                "visible": true,
                "tooltip": "Name of the session that will be created to execute this action on AWS.",
                "description": "Name of the session that will be created to execute this action on AWS."
              }
            ]
          }
        },
        {
          "title": "Analyzer ARN",
          "type": "select",
          "name": "analyzer_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of analyzers.",
          "description": "Select the arn of analyzers from list",
          "apiOperation": "list_analyzers_only_arn"
        },
        {
          "title": "Resource ARN",
          "type": "select",
          "name": "resource_arn",
          "required": true,
          "editable": true,
          "visible": true,
          "tooltip": "select the arn of resources.",
          "description": "Select the arn of resources",
          "apiOperation": "list_analyzed_resources_only_arn"
        },
        {
          "title": "ID List",
          "type": "json",
          "name": "ids",
          "required": true,
          "editable": true,
          "visible": true,
          "value": [],
          "placeholder": ["id1", "id2"],
          "tooltip": "Comma separated list of ID's.",
          "description": "Comma separated list of ID's."
        },
        {
          "title": "Status",
          "type": "select",
          "name": "status",
          "required": true,
          "editable": true,
          "visible": true,
          "value": "ACTIVE",
          "tooltip": "Specify the status 'ACTIVE' or 'ARCHIVED'",
          "description": "Specify the status 'ACTIVE' or 'ARCHIVED'",
          "options": [
            "ACTIVE",
            "ARCHIVED"
          ]
        },
        {
          "title": "Client Token",
          "type": "text",
          "name": "client_token",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "Specifies the client token",
          "description": "Specifies the client token"
        }
      ],
      "enabled": true,
      "output_schema": null
    }
  ]

}